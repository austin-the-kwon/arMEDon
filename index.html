<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>

  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  
  <title>My Work is in the Heart</title>
  <style>
    :root {
      --title-color: #00A9B7; /* Change this to whatever color you want */
    }

    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
    }

    header {
      position: relative; /* Needed for absolute positioning of the menu */
      display: flex; /* To align h1 and menu */
      justify-content: center; /* Center the h1 initially */
      align-items: center;
      margin-top: 20px;
    }

    header h1 {
      color: var(--title-color);
      font-family: Arial, sans-serif; /* Corrected font-family property */
      text-align: center;
      font-size: 2.5em;
      margin: 0; /* Remove default margin to help with centering */
      flex-grow: 1; /* Allows h1 to take up available space */
    }

    article {
      max-width: 700px;
      margin: 40px auto;
      line-height: 1.6;
      color: #333;
    }

    a {
    color: #00A9B7; /* Set your desired color */
    text-decoration: underline; /* Optional: removes underline */
    }

    h2 {
      font-size: 1.8em;
    }

    /* Ensure math equations are left-aligned */
    .math-center {
      text-align: left; /* Left-align the entire block */
      display: block;    /* Ensure it's treated as a block-level element */
      margin: 30px 0;
    }

    /* Additional specific targeting for MathJax rendered equations */
    .mjx-chtml {
      text-align: left !important; /* Force MathJax to align content left */
    }

    .mjx-math {
      text-align: left !important; /* Ensure MathJax equations are left-aligned */
    }

    /* Hamburger Menu Styles */
    .hamburger-menu {
      position: absolute;
      top: 0;
      right: 20px; /* Adjust as needed for spacing from the right edge */
      z-index: 1000; /* Ensure it's on top of other content */
    }

    .hamburger-icon {
      width: 30px;
      height: 25px;
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      cursor: pointer;
      padding: 5px; /* Add some padding around the icon for easier clicking */
    }

    .hamburger-icon .bar {
      width: 100%;
      height: 3px;
      background-color: #333; /* Color of the bars */
      transition: all 0.3s ease-in-out;
    }

    .nav-menu {
      list-style: none;
      padding: 0;
      margin: 0;
      background-color: #f4f4f4; /* Background for the dropdown menu */
      border: 1px solid #ddd;
      position: absolute;
      top: 40px; /* Position below the icon */
      right: 0;
      width: 150px; /* Width of the dropdown menu */
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      display: none; /* Hidden by default */
    }

    .nav-menu.active {
      display: block; /* Show when active */
    }

    .nav-menu li a {
      display: block;
      padding: 10px 15px;
      text-decoration: none;
      color: #333;
      white-space: nowrap; /* Prevent text wrapping */
    }

    .nav-menu li a:hover {
      background-color: #e2e2e2;
    }

    /* Animation for the hamburger icon when active */
    .hamburger-icon.active .bar:nth-child(1) {
      transform: translateY(11px) rotate(45deg);
    }

    .hamburger-icon.active .bar:nth-child(2) {
      opacity: 0;
    }

    .hamburger-icon.active .bar:nth-child(3) {
      transform: translateY(-11px) rotate(-45deg);
    }

    /* Media query for smaller screens if you want the menu to always be a hamburger */
    @media (max-width: 768px) {
      header h1 {
        text-align: left; /* Adjust h1 position on smaller screens */
        padding-left: 20px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>My Work is in the Heart</h1>
    <div class="hamburger-menu">
      <div class="hamburger-icon" id="hamburgerIcon">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
      </div>
      <ul class="nav-menu" id="navMenu">
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#Synthetic Vascular Tree">Synthetic Vascular Tree</a></li>
        <li><a href="#1D Wave Propagation: Mass Conservation Derivation">1D Wave Propagation: Mass Conservation Derivation</a></li>
        <li><a href="#1D Wave Propagation: Momentum Derivation">1D Wave Propagation: Momentum Derivation</a></li>
        <li><a href="#1D Wave Propagation: Quasi-Linearization of Strong Form">1D Wave Propagation: Quasi-Linearization of Strong Form</a></li>
      </ul>
    </div>
  </header>

  <article id="introduction">
    <h2>Introduction</h2>
    <p>The aim of this blog is to outline the mathematics and techniques used to create a model of the heart. </p>
  </article>

  <article id="Synthetic Vascular Tree">
    <h2>Synthetic Vascular Tree</h2>
    <p>
      As a result of the coarseness of modern medical imaging machines, 
      image-to-model techniques are suited to segment the lumen of large coronary arteries 
      and other medium-sized marginal vessels, whether manually or automatically. However, with an in-plane resolution
      of roughly 500 microns, vessels with smaller diameters, such as pre-arterioles and arterioles with 500-100 micron and  
      100-50 micron diameters respectively, synthetic vascular trees need to be generated to create domains to run
      hemodynamic simulations and bridge the gap between 3D flow in the large coronary arteries and porous medium 
      perfusion in the myocardium.
    </p>
    <div class="math-center">
      \[
      \begin{aligned}
        r_0^\gamma &= r_1^\gamma + r_2^\gamma \\
        Q_0 &= Q_1 + Q_2
      \end{aligned}
      \]
    </div>
  </article>

  <article id="1D Wave Propagation: Mass Conservation Derivation">
    <h2>1D Wave Propagation: Mass Conservation Derivation</h2>
    <p>
      Arteriole vessels range in diameter between 100 and 50 microns. In concordance with average values of
      vessel segment length \(\approx\) 0.3-0.5 cm, velocity \(\approx\) 1 cm/s, and viscosity \(\approx\) 3.6 mPa\(\cdot\)s 
      (disregarding shear thinning), a crude approximation of the average Reynolds number in an arteriole segment is
      \(\approx\) 0.29 which is well within the laminar regime. With that established, the remainder of this section will derive the 
      weak, quasi-linear form of the 1D wave propagation equation in a flexible tube, starting with the equations of mass conservation and 
      axial component of the Navier-Stokes momentum equation in cylindrical coordinates.
    </p>

    <p>
      With density \(\rho\), velocity in cylindrical coordinates \(\vec{u} = [u_z, u_r, u_\theta]^T\), 
      and axial direction z, we start with the equation for conservation of mass.
    </p>
    
    <div class="math-center">
      \[
      \frac{\partial \rho}{\partial z}+\nabla\cdot\rho \vec{u} = 0
      \]
    </div>

    <p>
      Using the divergence identity: \( \nabla\cdot \rho \vec{u}=
      \rho\left(\nabla\cdot\vec{u}\right)+\vec{u}\cdot\nabla\rho\), we substitute the divergence term
      to arrive at:
    </p>
    
    <div class="math-center">
      \[
      \frac{\partial \rho}{\partial z}+ 
      \rho\left(\nabla\cdot\vec{u}\right)+\vec{u}\cdot\nabla\rho = 0
      \]
    </div>

    <p>
    Assuming blood is a homogeneous fluid, with uniform density throughout the fluid domain,
    we set the gradient of density to be zero (\(\nabla \rho = 0\)).
    </p>

    <div class="math-center">
      \[
      \frac{\partial \rho}{\partial z}+ 
      \rho\left(\nabla\cdot\vec{u}\right) = 0
      \]
    </div>

    <p>
      Substituting for the divergence of velocity with the following identity,
      \(\nabla\cdot\vec{u}=\frac{\partial u_z}{\partial z}
      +\frac{1}{r}\frac{\partial(ru_r)}{\partial z}+
      \frac{1}{r}\frac{\partial u_\theta}{\partial \theta}\), we get the following:
    </p>

    <div class="math-center">
      \[
      \frac{\partial \rho}{\partial z}+ 
      \rho\left(\frac{\partial u_z}{\partial z}
      +\frac{1}{r}\frac{\partial(ru_r)}{\partial z}+
      \frac{1}{r}\frac{\partial u_\theta}{\partial \theta}\right) = 0
      \]
    </div>

    <p>
      Assuming that the flow in the pipe is axisymmetric (no \(\theta\) dependance),
      we set the \(\frac{\partial}{\partial\theta}\) term to zero:
    </p>

    <div class="math-center">
      \[
      \frac{\partial \rho}{\partial z}+ 
      \rho\left(\frac{\partial u_z}{\partial z}
      +\frac{1}{r}\frac{\partial(ru_r)}{\partial z}\right) = 0
      \]
    </div>

    <p>
      As blood is nearly incompressible in the arterioles, we set the density
      time derivative term to zero, which then allows us to divide by \(\rho\)
      on both sides to remove the constant.
    </p>

    <div class="math-center">
      \[
      \frac{\partial u_z}{\partial z}
      +\frac{1}{r}\frac{\partial(ru_r)}{\partial z} = 0
      \]
    </div>

    <p>
      Going forward, we will assume that our fluid domain always has a circular cross-sectional 
      area. After this assumption, we will multiply by \(2\pi r\), 
      for the radial position r, and then integrate from 0 to \(R\),
      the outer radius of the fluid domain.
    </p>

    <div class="math-center">
      \[
      \int_0^R2\pi r\frac{\partial u_z}{\partial z}dr
      +\int_0^R2\pi \frac{\partial(ru_r)}{\partial z}dr = 0
      \]
    </div>

    <p> 
      By noting that the integral of the radial velocity term is equal to 
      \(\int_0^R2\pi \frac{\partial(ru_r)}{\partial z}dr = 2\pi Ru_r(R)\), where
      \(u_r(R)\) is the radial velocity at the radial position \(r = R\), we get:
    </p>

    <div class="math-center">
      \[
      \int_0^R2\pi r\frac{\partial u_z}{\partial z}dr
      +2\pi Ru_r(R) = 0
      \]
    </div>

    <p>
      A very useful tool we will use, which will reappear later, is the Leibniz rule. 
      A general expression of the Leibniz rule will be outlined for the reader's convenience:
    </p>

    <div class="math-center">
      \[
      \frac{\partial}{\partial z}\int_{a(z)}^{b(z)} f(z,t)dt = 
      f(z,b(z))\cdot\frac{\partial b(z)}{\partial z}-
      f(z,a(z))\cdot\frac{\partial a(z)}{\partial z}+
      \int_{a(z)}^{b(z)} \frac{\partial f(z,t)}{\partial z}dt
      \]
    </div>

    <p>
      After making substitutions with terms in the mass conservation equation 
      with terms in the general expression of the Leibniz rule and rearranging
      some of the resulting terms, we arrive at the following identity:
    </p>

    <div class="math-center">
      \[
      \begin{aligned}
        \frac{\partial}{\partial z}\int_{R}^{0} 2\pi r u_z dr &= 
        2\pi Ru_z(R)\cdot\frac{\partial R}{\partial z}+
        \int_{R}^{0} 2\pi r\frac{\partial u_r}{\partial z}dr\\
        &\Updownarrow \text{ rearrange terms}\\
        \int_{R}^{0} 2\pi r\frac{\partial u_r}{\partial z}dr&=
        \frac{\partial}{\partial z}\int_{R}^{0} 2\pi r u_z dr - 
        2\pi Ru_z(R)\cdot\frac{\partial R}{\partial z}
      \end{aligned}
      \]
    </div>

    <p>
      Substituting the integral with the Leibniz-obtained terms, we get:
    </p>

    <div class="math-center">
      \[
      \frac{\partial}{\partial z}\int_{R}^{0} 2\pi r u_z dr - 
      2\pi Ru_z(R)\cdot\frac{\partial R}{\partial z}
      +2\pi Ru_r(R) = 0
      \]
    </div>

    <p>
      Substituting for the definition of volumetric flow through a circular area 
      (\(Q = \int_0^R2\pi r u_z dr\)) and then the identity of the radial component
      of velocity at the outer radius 
      (\(u_r(R)=\frac{\partial R}{\partial t}+u_z(R)\frac{\partial R}{\partial z}\)), we get:
    </p>

    <div class="math-center">
      \[
      \begin{aligned}
        \frac{\partial Q}{\partial z} - 
        2\pi Ru_z(R)\cdot\frac{\partial R}{\partial z}
        &+2\pi R\left[\frac{\partial R}{\partial t}
        +u_z(R)\frac{\partial R}{\partial z}\right] = 0\\
        &\Updownarrow \text{ terms cancel}\\
        \frac{\partial Q}{\partial z}
        &+2\pi R\frac{\partial R}{\partial t} = 0
      \end{aligned}
      \]
    </div>
    
    <p>
      And then finally, using the identity for the time rate of change of the 
      cross sectional area 
      \(\left(A=\pi R^2 \Rightarrow \frac{\partial A}{\partial t}=2\pi R\frac{\partial R}{\partial t}\right)\),
      we get the mass conservation equation in a 1D flexible tube:
    </p>

    <div class="math-center">
      \[
      \frac{\partial A}{\partial t}+\frac{\partial Q}{\partial z} = 0
      \]
    </div>
  </article>

  <article id="1D Wave Propagation: Momentum Derivation">
    <h2>1D Wave Propagation: Momentum Derivation</h2>
    <p>
      Work in progress...
    </p>
  </article>

  <article id="1D Wave Propagation: Quasi-Linearization of Strong Form">
    <h2>1D Wave Propagation: Quasi-Linearization of Strong Form</h2>
    <p>
      Most of the work in this section will be done in the momentum equation. The strong form of the
      system of equations will be turned to a quasi-linear form to ...
    </p>

    <div class="math-center">
      \[
        \frac{\partial Q(z,t)}{\partial t}
        +\frac{\partial}{\partial z}\left[(1+\delta)\frac{Q(z,t)^2}{A(z,t)}\right]
        +\frac{A(z,t)}{\rho}\frac{\partial P(z,t)}{\partial z}=A(z,t)f(z,t)+\frac{NQ(z,t)}{A(z,t)}
        +\nu\frac{\partial^2Q(z,t)}{\partial z^2}
      \]
    </div>

    <p>
      Before proceeding, we need to set some definitions. Normally, pressure 
      and cross-sectional area are functions of z and t.
    </p>
    
    <div class="math-center">
      \[
        P = P(z,t) \qquad A = A(z,t)
      \]
    </div>
    
    <p>
      But now we will introduce "pseudo-equations" of pressure and cross-sectional area that are
      additionally dependent on cross-sectional area and pressure respectively:
    </p>

    <div class="math-center">
      \[
        P = P(z,t) = \tilde{P}(A(z,t),z,t) \qquad A = A(z,t) = \tilde{A}(P(z,t),z,t)
      \]
    </div>

    <p>
      These definitions are established to expand the pressure derivative term with help from the
      pressure-area relation from Olufsen, which we can invert to get the relation in both directions.
    </p>

    <div class="math-center">
      \[
      \begin{aligned}
        \tilde{P}(A(z,t),z,t) &= P_0(z) + \frac{4}{3}\left(k_1 \text{exp}\left(k_2r_0(z)\right)+k_3\right)
        \left(1-\sqrt{\frac{A_0(z)}{A(z,t)}}\right)\\
        &\Updownarrow\text{ invert}\\
        \tilde{A}(P(z,t),z,t) &= \frac{A_0(z)}
        {\left[1-\frac{3\left(P(z,t)-P_0(z)\right)}
        {4\left(k_1 \text{exp}\left(k_2r_0(z)\right)+k_3\right)}\right]^2}
      \end{aligned}
      \]
    </div>

    <p>
      Where \(k_1, k_2, \) and \(k_3\) are constants that are indicative of the material properties
      of the vessel walls. Now we can use Leibniz rule, which have 
      partial derivatives of cross-sectional area with respect to axial position evaluated 
      at internal and external pressures (which we now have!), to expand the pressure derivative to
      a friendlier form for quasi-linearizing the system of equations.
    </p>

    <div class="math-center">
      \[
      \begin{aligned}
        \frac{\partial}{\partial z}\int_{P_0(z)}^{P(z,t)}\frac{1}{\rho}\tilde{A}(p',z,t)dp'&=
        \frac{\tilde{A}(P(z,t),z,t)}{\rho}\frac{\partial P(z,t)}{\partial z}-
        \frac{\tilde{A}(P_0(z),z,t)}{\rho}\frac{\partial P_0(z,t)}{\partial z}+
        \int_{P_0(z)}^{P(z,t)}\frac{1}{\rho}\frac{\partial \tilde{A}(p',z,t)}{\partial z}dp'\\
        &\Updownarrow \text{definition: }A(z,t) = \tilde{A}(P(z,t),z,t)\text{ and }\tilde{A}(P_0(z),z,t)=A_0(z)\\
        \frac{\partial}{\partial z}\int_{P_0(z)}^{P(z,t)}\frac{1}{\rho}\tilde{A}(p',z,t)dp'&=
        \frac{A(z,t)}{\rho}\frac{\partial P(z,t)}{\partial z}-
        \frac{A_0(z)}{\rho}\frac{\partial P_0(z)}{\partial z}+
        \int_{P_0(z)}^{P(z,t)}\frac{1}{\rho}\frac{\partial \tilde{A}(p',z,t)}{\partial z}dp'\\
        &\Updownarrow \text{rearrange terms}\\
        \frac{A(z,t)}{\rho}\frac{\partial P(z,t)}{\partial z}&=
        \frac{\partial}{\partial z}\int_{P_0(z)}^{P(z,t)}\frac{1}{\rho}\tilde{A}(p',z,t)dp'
        +\frac{A_0(z)}{\rho}\frac{\partial P_0(z)}{\partial z}-
        \int_{P_0(z)}^{P(z,t)}\frac{1}{\rho}\frac{\partial \tilde{A}(p',z,t)}{\partial z}dp'
      \end{aligned}
      \]
    </div>

    <p>
      Plugging this equation into the original momentum equation, we get:
    </p>

    <div class="math-center">
      \[
        \frac{\partial Q(z,t)}{\partial t}
        +\frac{\partial}{\partial z}\left[(1+\delta)\frac{Q(z,t)^2}{A(z,t)}\right]
        +\frac{\partial}{\partial z}\int_{P_0(z)}^{P(z,t)}\frac{1}{\rho}\tilde{A}(p',z,t)dp'
        +\frac{A_0(z)}{\rho}\frac{\partial P_0(z)}{\partial z}-
        \int_{P_0(z)}^{P(z,t)}\frac{1}{\rho}\frac{\partial \tilde{A}(p',z,t)}{\partial z}dp'=A(z,t)f(z,t)+\frac{NQ(z,t)}{A(z,t)}
        +\nu\frac{\partial^2Q(z,t)}{\partial z^2}
      \]
    </div>

    <p>
      Nominally, studies on reduced order models of blood flow will assume blood is a Newtonian fluid.
      This is a valid assumption for blood flow in large arteries where shear thinning hardly occurs.
      In the arterioles, however, due to the small diameter of vessels, shear thinning has a substantial effect on the
      flow. As such, viscosity \(\nu\) can no longer be assumed to be constant, but rather a function of 
      volumetric flow and cross-sectional area.
    </p>

    <div class="math-center">
      \[
        \nu = \nu(A(z,t), Q(z,t))
      \]
    </div>
    
  </article>
  
  <script>
      
  const hamburgerIcon = document.getElementById('hamburgerIcon');
  const navMenu = document.getElementById('navMenu');

  hamburgerIcon.addEventListener('click', () => {
    hamburgerIcon.classList.toggle('active');
    navMenu.classList.toggle('active');
  });

  // Close the menu if clicked outside
  document.addEventListener('click', (event) => {
    if (!hamburgerIcon.contains(event.target) && !navMenu.contains(event.target)) {
      hamburgerIcon.classList.remove('active');
      navMenu.classList.remove('active');
    }
  });

  // Close the menu when a link is clicked
  navMenu.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      hamburgerIcon.classList.remove('active');
      navMenu.classList.remove('active');
    });
  });
</script>
</body>
</html>
