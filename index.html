<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>

  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  
  <title>My Work is in the Heart</title>
  <style>
    :root {
      --title-color: #bf5700; /* Change this to whatever color you want */
    }

    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
    }

    header {
      position: relative; /* Needed for absolute positioning of the menu */
      display: flex; /* To align h1 and menu */
      justify-content: center; /* Center the h1 initially */
      align-items: center;
      margin-top: 20px;
    }

    header h1 {
      color: var(--title-color);
      font-family: Arial, sans-serif; /* Corrected font-family property */
      text-align: center;
      font-size: 2.5em;
      margin: 0; /* Remove default margin to help with centering */
      flex-grow: 1; /* Allows h1 to take up available space */
    }

    article {
      max-width: 700px;
      margin: 40px auto;
      line-height: 1.6;
      color: #333;
    }

    a {
    color: #00A9B7; /* Set your desired color */
    text-decoration: underline; /* Optional: removes underline */
    }

    h2 {
      font-size: 1.8em;
    }

    /* Ensure math equations are left-aligned */
    .math-center {
      text-align: left; /* Left-align the entire block */
      display: block;    /* Ensure it's treated as a block-level element */
      margin: 30px 0;
    }

    /* Additional specific targeting for MathJax rendered equations */
    .mjx-chtml {
      text-align: left !important; /* Force MathJax to align content left */
    }

    .mjx-math {
      text-align: left !important; /* Ensure MathJax equations are left-aligned */
    }

    /* Hamburger Menu Styles */
    .hamburger-menu {
      position: absolute;
      top: 0;
      right: 20px; /* Adjust as needed for spacing from the right edge */
      z-index: 1000; /* Ensure it's on top of other content */
    }

    .hamburger-icon {
      width: 30px;
      height: 25px;
      display: flex;
      flex-direction: column;
      justify-content: space-around;
      cursor: pointer;
      padding: 5px; /* Add some padding around the icon for easier clicking */
    }

    .hamburger-icon .bar {
      width: 100%;
      height: 3px;
      background-color: #333; /* Color of the bars */
      transition: all 0.3s ease-in-out;
    }

    .nav-menu {
      list-style: none;
      padding: 0;
      margin: 0;
      background-color: #f4f4f4; /* Background for the dropdown menu */
      border: 1px solid #ddd;
      position: absolute;
      top: 40px; /* Position below the icon */
      right: 0;
      width: 150px; /* Width of the dropdown menu */
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
      display: none; /* Hidden by default */
    }

    .nav-menu.active {
      display: block; /* Show when active */
    }

    .nav-menu li a {
      display: block;
      padding: 10px 15px;
      text-decoration: none;
      color: #333;
      white-space: nowrap; /* Prevent text wrapping */
    }

    .nav-menu li a:hover {
      background-color: #e2e2e2;
    }

    /* Animation for the hamburger icon when active */
    .hamburger-icon.active .bar:nth-child(1) {
      transform: translateY(11px) rotate(45deg);
    }

    .hamburger-icon.active .bar:nth-child(2) {
      opacity: 0;
    }

    .hamburger-icon.active .bar:nth-child(3) {
      transform: translateY(-11px) rotate(-45deg);
    }

    /* Media query for smaller screens if you want the menu to always be a hamburger */
    @media (max-width: 768px) {
      header h1 {
        text-align: left; /* Adjust h1 position on smaller screens */
        padding-left: 20px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>My Work is in the Heart</h1>
    <div class="hamburger-menu">
      <div class="hamburger-icon" id="hamburgerIcon">
        <div class="bar"></div>
        <div class="bar"></div>
        <div class="bar"></div>
      </div>
      <ul class="nav-menu" id="navMenu">
        <li><a href="#introduction">Introduction</a></li>
        <li><a href="#mathematical-background">Mathematical Background</a></li>
        <li><a href="#code-implementation">Code Implementation</a></li>
        <li><a href="#about-the-author">About the Author</a></li>
      </ul>
    </div>
  </header>

  <article id="introduction">
    <h2>Introduction</h2>
    <p>The aim of this blog is to outline the mathematics and techniques used to create a model of the heart. </p>
  </article>

  <article id="Synthetic Vascular Tree">
    <h2>Synthetic Vascular Tree</h2>
    <p>
      As a result of the coarseness of modern medical imaging machines, 
      image-to-model techniques are suited to segment the lumen of large coronary arteries 
      and other medium-sized marginal vessels, whether manually or automatically. However, with an in-plane resolution
      of roughly 500 microns, vessels with smaller diameters, such as pre-arterioles and arterioles with 500-100 micron and  
      100-50 micron diameters respectively, synthetic vascular trees need to be generated to create domains to run
      hemodynamic simulations and bridge the gap between 3D flow in the large coronary arteries and porous medium 
      perfusion in the myocardium.
    </p>
    <div class="math-center">
      \[
      \begin{aligned}
        r_0^\gamma &= r_1^\gamma + r_2^\gamma \\
        Q_0 = Q_1 + Q_2
      \end{aligned}
      \]
    </div>
  </article>
    <p>
      For applications in a time-series prediction task, a sequence of ground-truth state variables \([x_0,...,x_n]\) 
      can be given as input to the S4 model to output a one-step shifted sequence of predicted state variables
      \([\hat{x}_1,...,\hat{x}_{n+1}]\). The subscript indicates the time step index and the hat notation indicates
      that the variable is a model prediction. 
      The state variable at each time step has dimension d, and the hidden state has dimension h.
    </p> 
    <div class="math-center">
      \[
      \begin{aligned}
        &x_t, \hat{x}_t \in \mathbb{R}^{d} \\
        &h_t \in \mathbb{R}^{\symcal{h}}
      \end{aligned}
      \]
    </div>
    <p>
      Setting the hidden state at timestep t = 0 shows
    </p>
    <div class="math-center">
      \[
      \begin{aligned}
        h_1 &= Ah_0 + Bx_0 = Bx_0\\
        \hat{x}_1 &= Ch_1 + Dx_0 = CBx_0 + Dx_0\\
        &\\
        h_2 &= Ah_1 + Bx_1 = ABx_0 + Bx_1\\
        \hat{x}_2 &= Ch_2 + Dx_1 = CABx_0 + CBx_1 + Dx_1\\
        &\\
        h_3 &= Ah_2 + Bx_2 = A^2Bx_0 + ABx_1 + Bx_2\\
        \hat{x}_3 &= Ch_3 + Dx_2 = CA^2Bx_0  +CABx_1 + CBx_2 + Dx_2\\
        &\\
        h_4 &= Ah_3 + Bx_3 = A^3Bx_0 + A^2Bx_1 + ABx_2 + Bx_3\\
        \hat{x}_4 &= Ch_4 + Dx_3 = CA^3Bx_0 + CA^2Bx_1  +CABx_2 + CBx_3 + Dx_3\\
        &\\
      &\text{and so on...}
      \end{aligned}
      \]
    </div>
    <p>From this explicit iteration, it can be shown that the predicted output (\(\hat{x}_{n+1}\)) follows 
    a formula:</p>
    <div class="math-center">
      \[
      \hat{x}_{n+1} = \sum_{j=0}^{n}CA^{n-j}Bx_j + Dx_n
      \]
    </div>
    <p>
      A key technical contribution of the S4 paper by Gu et. al, is setting the A matrix 
      as a HiPPO matrix and characterizing this matrix as a diagonal plus low rank (NPLR) 
      matrix (under unitary transformation) to simplify calculations for efficient computation.
      A normal matrix can be expressed as \(V\Lambda V^*\) where V is a unitary matrix, \(VV^*=V^*V=I\), 
      and \(\Lambda\) is a diagonal matrix. 
      To obtain a low rank matrix, one can take an outer product of two low rank matrices.
      Upon a unitary transformation (multiplication by a unitary matrix and its conjugate transpose on either side), 
      an NPLR matrix can be converted to a diagonal plus low-rank (DPLR) matrix.
    </p>
    <div class="math-center">
      \[
      \begin{aligned}
        A &= V\Lambda V^* - PQ^*\\
        V^*AV &= V^*(V\Lambda V^* - PQ^*)V=V^*V\Lambda V^*V - V^*PQ^*V = \Lambda - V^*PQ^*V\\
        &\text{let }\tilde{P} = V^*P\text{ and }\tilde{Q} = V^*Q\\
        A &=\Lambda - \tilde{P}\tilde{Q}^*
      \end{aligned}
      \]
    </div>
    Since multiplcation by a unitary matrix does not affect rank, \(\tilde{P}\) and  \(\tilde{Q}\)
    have the same rank as P and Q.

    <p>Dimensions for the parameters are as follows:</p>
    <div class="math-center">
      \[
      \begin{aligned}
        &\Lambda \in \mathbb{C}^{h\times h}\text{ (diagonal matrix)} \\
        &P, Q \in \mathbb{C}^{h \times r} \\
        &B, C \in \mathbb{C}^{h \times d}
      \end{aligned}
      \]

<script>
  const hamburgerIcon = document.getElementById('hamburgerIcon');
  const navMenu = document.getElementById('navMenu');

  hamburgerIcon.addEventListener('click', () => {
    hamburgerIcon.classList.toggle('active');
    navMenu.classList.toggle('active');
  });

  // Close the menu if clicked outside
  document.addEventListener('click', (event) => {
    if (!hamburgerIcon.contains(event.target) && !navMenu.contains(event.target)) {
      hamburgerIcon.classList.remove('active');
      navMenu.classList.remove('active');
    }
  });

  // Close the menu when a link is clicked
  navMenu.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      hamburgerIcon.classList.remove('active');
      navMenu.classList.remove('active');
    });
  });
</script>
</body>
</html>
